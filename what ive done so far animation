import java.io.IOException;
import java.io.PrintWriter;
import javax.imageio.ImageIO;
import javax.servlet.ServletException;
import javax.servlet.ServletOutputStream;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import java.awt.Graphics2D;
import java.awt.image.BufferedImage;
import java.awt.*;
import net.jmge.gif.Gif89Encoder;
@WebServlet("/GroupStuff")

public class Groupproject extends HttpServlet {
	private static final long serialVersionUID = 1L;
	public Groupproject() {
		super();
	}
	static void drawFrame(Graphics2D g, int frame, Color box1, Color box2){			
		g.setColor(box1);
		g.fillRect(0,0,150,100);
		g.setColor(box2);
		g.fillRect(50,8*frame-20,50,20);
		g.setColor(Color.white);
		g.fillRect(0, 100, 150, 150);
	}	
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		if (request.getParameter("box1") == null){ // The user has not given us a number.
			response.setContentType("text/html");
			PrintWriter out = response.getWriter();
			out.println("<form>");
			out.println("Background Colour: <input name= 'box1' value='FF0000'/><br>");
			out.println("shape colour: <input name= 'box2' value='0000FF'/><br>");		
			out.println("Direction-down: <input name= 'Direction1' value=''/><br>");	
			out.println("Direction-up: <input name= 'Direction2' value=''/><br>");
			out.println("Direction-left: <input name= 'Direction3' value=''/><br>");	
			out.println("Direction-right: <input name= 'Dircetion4' value=''/><br>");	
			out.println("<input type= 'submit'/>");
			out.println("<form>");
		}else{// We have a number (hopefully) let's use that number to make an image
			response.setContentType("image/gif");
			BufferedImage image = new BufferedImage(150, 200, BufferedImage.TYPE_INT_ARGB);
			Graphics2D g = image.createGraphics();
			Color box1 = new Color(Integer.parseInt(request.getParameter("box1"),16));
			Color box2 = new Color(Integer.parseInt(request.getParameter("box2"),16));
			try {   
				response.setContentType("image/gif");
				Gif89Encoder genc = new Gif89Encoder(); 
				for (int i=0;i<20;i++){ //running as it is this makes the object move upwards
					//for (int i=15;i>-20;i--){ this makes the shape move up
					drawFrame(g,i, box1 , box2);
					genc.addFrame(image);
					//g.dispose();
				}
				genc.setUniformDelay(10);
				genc.setLoopCount(0);
				genc.encode(response.getOutputStream());
			}catch(Exception e){
				System.err.println(e);
			}
		}
	}       
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	}
}
